import{j as e,a as t,r as l,c as h}from"./jsx-runtime.507626cb.js";/* empty css             *//* empty css            */function g(o){return e("main",{children:o.msgs.map((i,r)=>e("div",{className:"chat-message",children:t("div",{className:"chat-message-header",children:[e("span",{className:"chat-message-header-user msg-author msgh",color:i.user=="amukh1"?"yellow":"white",children:i.user}),"-",e("span",{className:"chat-message-header-time msg-time msgh",children:i.time}),e("div",{className:"chat-message-content",children:i.msg})]})}))})}function u(){window.localStorage.getItem("user")==null&&(window.location.href="https://amukh1.github.io/Arch/login",alert("You are not logged in"),window.location.href="https://amukh1.github.io/Arch/login",window.location.reload());let o=window.location.hash.slice(1);const[i,r]=l.exports.useState([]),[m,d]=l.exports.useState([]);document.title=`Room: ${o}`;let a;return l.exports.useEffect(()=>{a=window.localStorage.getItem("user");const n=new WebSocket("wss://api.arch.amukh1.dev");n.onopen=function(){console.log("WebSocket Client Connected"),n.send(JSON.stringify({type:"join",room:o,user:a}))},n.onmessage=function(c){let s=JSON.parse(c.data);console.log("Received: "),console.log(s),s.type=="msg"?s.user==a?console.log("same user msg rte?"):s.room==o?(console.log("same room msg rte?"),r(w=>s.msgs)):console.log("not same room"):s.type=="ready"?(s.user==a&&(console.log("same user join rte?"),r(s.msgs)),s.room==o&&(console.log("same room join rte?"),d(s.users))):s.type=="shoot"&&(s.user==a&&console.log("same user shoot rte?"),document.body.classList.add("blur"))},document.addEventListener("keypress",c=>{c.key==="Enter"&&document.getElementById("msges").value!==""&&(r(s=>[...s,{user:a,time:new Date().toLocaleTimeString(),msg:document.getElementById("msges").value}]),n.send(JSON.stringify({type:"msg",room:o,user:a,token:window.localStorage.getItem("token"),msg:{user:a,time:new Date().toLocaleTimeString(),msg:document.getElementById("msges").value}})),setTimeout(()=>{document.getElementById("msges").value=""},0))})},[]),t("main",{children:[t("div",{className:"sidebar",children:[e("div",{className:"sidebar-header",children:t("h3",{children:["Room: ",o]})}),t("div",{className:"sidebar-body",children:[e("input",{type:"text",className:"cri cr",id:"cr",placeholder:"14"}),e("br",{}),e("button",{className:"crb cr",onClick:p,children:"Change room"})]})]}),t("div",{className:"main",children:[t("div",{className:"chat-window",children:[t("div",{className:"chat-header",children:["Room: ",o,", ",m.length," Participants, ",new Date().toDateString()," | ARCH"]}),t("div",{className:"chat-body",children:[console.log("RENDERING!!"),e(g,{msgs:i})]})]}),t("div",{className:"right-sidebar",children:[e("div",{className:"chat-header",children:"Users"}),e("div",{className:"chat-users-body",children:m.map((n,c)=>t("div",{className:"chat-user",children:[t("div",{className:"chat-user-name m",children:[n.user,":"]}),e("div",{className:"chat-user-status m",children:n.status})]}))})]}),e("div",{className:"msg-input-bar-bottom",children:e("input",{type:"text",className:"msg-input",placeholder:"Type a message",id:"msges"})})]})]})}function p(){let o=document.getElementById("cr").value;window.location.href=window.location.href.split("#")[0]+`#${o}`,window.location.reload()}h.createRoot(document.getElementById("root")).render(e(u,{}));
